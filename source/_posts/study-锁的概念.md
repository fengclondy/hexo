---
layout: post
title: 锁的概念
date: 2018-09-17 11:28:33
tags: study
categories: study
---

###  一、为什么要用锁？

锁-是为了解决并发操作引起的脏读、数据不一致的问题。

### 二、锁实现的基本原理

#### 1、volatile

java允许线程访问共享变量， 为了确保共享变量能被准确和一致地更新，线程应该确保通过排他锁单独获得这个变量。volatile在多处理器开发中保证了共享变量的“ 可见性”。可见性的意思是当一个线程修改一个共享变量时，另外一个线程能读到这个修改的值。

结论：如果volatile变量修饰符使用恰当的话，它比synchronized的使用和执行成本更低，因为它不会引起线程上下文的切换和调度。

<!-- more -->

#### 2、synchronized
synchronized通过锁机制实现同步，当一个线程试图访问同步代码块时，它首先必须得到锁，退出或抛出异常时必须释放锁。具体表现为以下3种形式。

- 对于普通同步方法，锁是当前实例对象。
- 对于静态同步方法，锁是当前类的Class对象。
- 对于同步方法块，锁是Synchonized括号里配置的对象。

synchronized实现的锁是可重入锁，当前线程可以可以再次获得锁。